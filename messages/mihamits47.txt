Added a new version of the server and a test.

Good luck compiling, I have legit no clue how to do this. The includes are probably screwed up, should be corrected later today.